<?php
include 'Record.php';
class DBHelper
{
	private $db_host;
	private $db_table;
	private $db_user;
	private $db_pass;
	private $db_only;
	private $mysqli;
	function DBHelper(){
		$this->db_host= "localhost";
		$this->db_user= "bahadir";
		$this->db_pass= "can-yildiz";
		$this->db_only= "bahadir_can";
		$this->db_table= "Records";
		$this->mysqli=new mysqli($this->db_host,$this->db_user,$this->db_pass,$this->db_user) or die("Unable to connect to MySQL");
	}
	function addRecord($Record){
		try{
			$this->mysqli->query("INSERT INTO $this->db_table (name,email,website,comment,gender) VALUES('$Record->name','$Record->email','$Record->website','$Record->comment','$Record->gender')");
			echo 'Kayit Tamamlandi: '.$Record->name;
		}
		catch(Exception $e){
			echo 'Yakalanan olağandışılık: ',  $e->getMessage(), "\n";
		}
		
	}
	function getRecord($RID){
			try{
				$result = $this->mysqli->query("Select * from $this->db_table Where id=$RID");
				$data = $result->fetch_row();
				$return = new Record($data[0],$data[1],$data[2],$data[3],$data[4],$data[5]);
				return $return;
				
			}
			catch(mysqli_sql_exception $e){
				echo 'Yakalanan olağandışılık: ',  $e->getMessage(), "\n";
			}
		}
	
	function getAllRecords(){
		try{
			$a = array();
			$all = $this->mysqli->query("SELECT * from $this->db_table");
			while($obj= $all->fetch_object()){
				$temp=new Record($obj->id,$obj->name,$obj->email,$obj->website,$obj->comment,$obj->gender);
				$a[]=$temp;
			};
			return $a;
		}
		catch(Exception $e){
			echo 'Yakalanan olağandışılık: ',  $e->getMessage(), "\n";
		}
	}
	function updateRecord($Record){
		try{
			$this->mysqli->query("UPDATE $this->db_table SET name='$Record->name' ,email='$Record->email',website='$Record->website',comment='$Record->comment',gender='$Record->gender' WHERE id=$Record->id");
			echo 'Kayit Guncellendi: '.$Record->name;
		}
		catch(Exception $e){
			echo 'Yakalanan olağandışılık: ',  $e->getMessage(), "\n";
		}
	}
	function deleteRecord($Record){
		try{
			$this->mysqli->query("DELETE FROM $this->db_table WHERE id=$Record->id");
			echo 'Kayit Silindi: '.$Record->name;
		}
		catch(Exception $e){
			echo 'Yakalanan olağandışılık: ',  $e->getMessage(), "\n";
		}
	}
	
	
}
?>
